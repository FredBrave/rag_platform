{% extends "main.html" %}
{% block content %}

<div class="container">
    <div class="card">
        <h2>{{ conversacion.titulo }}</h2>
    </div>

    <div id="chat-box" class="card mt-4" style="max-height: 400px; overflow-y: auto; padding: 10px;">
        {% if mensajes %}
            {% for mensaje in mensajes %}
                <div style="margin-bottom: 10px; padding: 8px; border-radius: 8px;
                            {% if mensaje.rol == "usuario" %}
                                background-color: #d1e7dd; text-align: right;
                            {% else %}
                                background-color: #f8d7da; text-align: left;
                            {% endif %}">
                    <strong>{{ mensaje.get_rol_display }}</strong><br>
                    {{ mensaje.contenido }}<br>
                    <small>{{ mensaje.fecha }}</small>
                </div>
            {% endfor %}
        {% else %}
            <p>No hay mensajes todav√≠a.</p>
        {% endif %}
    </div>

    <form method="post" class="mt-3">
        {% csrf_token %}
        <div class="input-group">
            <input type="text" name="contenido" class="form-control" placeholder="Escribe un mensaje..." required>
            <button type="submit" class="btn btn-primary">Enviar</button>
        </div>
    </form>
</div>

<script>
    const chatBox = document.getElementById("chat-box");
    if (chatBox) {
        chatBox.scrollTop = chatBox.scrollHeight;
    }
</script>

{% endblock content %}
